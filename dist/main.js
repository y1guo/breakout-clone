(()=>{"use strict";class t{constructor(t){this.game=t,this.width=t.paddleWidth,this.height=t.paddleHeight,this.maxSpeed=t.gameWidth/1e3,this.reset()}reset(){this.position={x:(this.game.gameWidth-this.width)/2,y:.98*this.game.gameHeight-this.height},this.speed=0}draw(){this.game.ctx.fillStyle="#fce",this.game.ctx.fillRect(this.position.x,this.position.y,this.width,this.height)}moveLeft(){this.speed=-this.maxSpeed}moveRight(){this.speed=this.maxSpeed}stop(){this.speed=0}update(t){this.position.x+=this.speed*t,this.position.x<0?this.position.x=0:this.position.x>this.game.gameWidth-this.width&&(this.position.x=this.game.gameWidth-this.width)}}class i{constructor(t){this.game=t,this.numKeyHold=0,document.addEventListener("keydown",(t=>{switch(t.keyCode){case 37:this.game.paddle.speed>=0&&(this.numKeyHold++,this.game.paddle.moveLeft());break;case 39:this.game.paddle.speed<=0&&(this.numKeyHold++,this.game.paddle.moveRight());break;case 27:this.game.togglePaused();break;case 32:this.game.start()}})),document.addEventListener("keyup",(t=>{switch(t.keyCode){case 37:this.numKeyHold--,0===this.numKeyHold?this.game.paddle.stop():this.game.paddle.moveRight();break;case 39:this.numKeyHold--,0===this.numKeyHold?this.game.paddle.stop():this.game.paddle.moveLeft()}}))}}function e(t,i){let e=t.position.x+t.size/2,s=t.position.y+t.size/2,h=i.position.x,a=i.position.x+i.width,g=i.position.y,d=i.position.y+i.height;return h<=e&&e<=a&&g<=s&&s<=d}class s{constructor(t){this.image=document.getElementById("imgBall"),this.game=t,this.size=t.ballSize,this.reset()}reset(){this.position={x:.5*(this.game.gameWidth-this.size),y:.9*this.game.gameHeight},this.speed={x:this.game.gameWidth/5e3*Math.random(),y:-this.game.gameWidth/2e3},this.angle=0,this.angularSpeed=-this.speed.x/(.5*this.size)}update(t){this.position.x+=this.speed.x*t,this.position.y+=this.speed.y*t,this.angle+=this.angularSpeed*t;let i={x:this.position.x+this.size/2,y:this.position.y+this.size/2};i.x<0?(i.x=-i.x,this.speed.x=-this.speed.x):i.x>this.game.gameWidth&&(i.x=2*this.game.gameWidth-i.x,this.speed.x=-this.speed.x),i.y<0&&(i.y=-i.y,this.speed.y=-this.speed.y),this.position.y>this.game.gameHeight&&this.game.gameover(),e(this,this.game.paddle)&&(i.y=2*this.game.paddle.position.y-i.y,this.speed.y=-this.speed.y,this.speed.x+=.2*this.game.paddle.speed,this.angularSpeed=-this.speed.x/(.5*this.size)),this.position={x:i.x-this.size/2,y:i.y-this.size/2}}draw(){let t={x:this.position.x+this.size/2,y:this.position.y+this.size/2};this.game.ctx.translate(t.x,t.y),this.game.ctx.rotate(this.angle),this.game.ctx.drawImage(this.image,-this.size/2,-this.size/2,this.size,this.size),this.game.ctx.rotate(-this.angle),this.game.ctx.translate(-t.x,-t.y)}}class h{constructor(t,i){this.game=t,this.width=t.brickWidth,this.height=t.brickHeight,this.position=i,this.markedForDeletion=!1,this.color="#f";for(let t=0;t<2;t++)this.color+=Math.floor(8+6*Math.random()).toString(16)}update(){e(this.game.ball,this)&&(this.markedForDeletion=!0,this.game.ball.speed.y*=-1)}draw(){this.game.ctx.fillStyle=this.color,this.game.ctx.fillRect(this.position.x,this.position.y,this.width,this.height)}}let a=document.getElementById("canvas").getContext("2d"),g=new class{constructor(e){this.ctx=e,window.innerWidth/window.innerHeight>4/3?(this.gameHeight=window.innerHeight,this.gameWidth=this.gameHeight/3*4):(this.gameWidth=window.innerWidth,this.gameHeight=this.gameWidth/4*3),this.ctx.canvas.width=this.gameWidth,this.ctx.canvas.height=this.gameHeight,this.paddleWidth=.25*this.gameWidth,this.paddleHeight=.025*this.gameWidth,this.ballSize=.08*this.gameWidth,this.brickWidth=.1*this.gameWidth,this.brickHeight=.5*this.brickWidth,this.paddle=new t(this),this.ball=new s(this),this.gameState=2,new i(this)}reset(){this.bricks=function(t){let i=[],e=4+6*Math.random();for(let s=0;s<e;s++)for(let e=0;e<10;e++)if(Math.random()<.7){let a={x:t.brickWidth*e,y:t.brickHeight*s};i.push(new h(t,a))}return i}(this),this.paddle.reset(),this.ball.reset(),this.gameObjects=[...this.bricks,this.paddle,this.ball]}start(){2!==this.gameState&&3!==this.gameState&&4!==this.gameState||(this.reset(),this.gameState=1)}update(t){1===this.gameState&&(this.gameObjects.forEach((i=>{i.update(t)})),this.gameObjects=this.gameObjects.filter((t=>!t.markedForDeletion)),2===this.gameObjects.length&&(this.gameState=4))}draw(){this.ctx.clearRect(0,0,this.gameWidth,this.gameHeight),2===this.gameState&&(this.ctx.fillStyle="#222",this.ctx.fillRect(0,0,this.gameWidth,this.gameHeight),this.ctx.font=.1*this.gameHeight+"px Serif",this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.fillText("PRESS SPACE TO START",this.gameWidth/2,this.gameHeight/2)),1===this.gameState&&this.gameObjects.forEach((t=>{t.draw()})),0===this.gameState&&(this.gameObjects.forEach((t=>{t.draw()})),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.gameWidth,this.gameHeight),this.ctx.font=.1*this.gameHeight+"px Serif",this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.fillText("PAUSED",this.gameWidth/2,this.gameHeight/2)),3===this.gameState&&(this.gameObjects.forEach((t=>{t.draw()})),this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.gameWidth,this.gameHeight),this.ctx.font=.1*this.gameHeight+"px Serif",this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.fillText("GAME OVER",this.gameWidth/2,this.gameHeight/2)),4===this.gameState&&(this.gameObjects.forEach((t=>{t.draw()})),this.ctx.fillStyle="rgba(240, 192, 224, 0.5)",this.ctx.fillRect(0,0,this.gameWidth,this.gameHeight),this.ctx.font=.1*this.gameHeight+"px Serif",this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.fillText("VICTORY",this.gameWidth/2,this.gameHeight/2))}togglePaused(){1===this.gameState?this.gameState=0:0===this.gameState&&(this.gameState=1)}gameover(){this.gameState=3}}(a),d=0;requestAnimationFrame((function t(i){let e=i-d;d=i,g.update(e),g.draw(),requestAnimationFrame(t)}))})();